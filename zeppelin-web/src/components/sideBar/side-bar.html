<div ng-controller="SideBarCtrl as sideBar"
     class="side-bar"
     ng-class="{'list-in':listActive,'history-in':historyActive}">
  <div class="scroll-panel">
    <div class="header-bar side-head-bar">
      <a href="" class="back">&lt;&nbsp;返回</a>
      <a href="javascript:;" class="new-note" ng-show="!adding" ng-click="sideBar.showNewArea($event)">新建</a>
    </div>
    <div class="note-list">
      <div class="new-note-container"
           ng-class="{'validate-error':!!noteNameError}"
           ng-show="adding">
        <input class="input-new"
               ng-click="$event.stopPropagation()"
               ng-change="sideBar.handleNameChange()"
               ng-model="notename"
               ng-enter="sideBar.handleNameEnter()"/>
        <a href="javascript:;" class="btn-ok" ng-click="sideBar.createNote($event)">确定</a>
        <div class="error-area" ng-show="noteNameError">{{noteNameError}}</div>
      </div>
      <!--repeat start-->
      <div class="note-list-item"
           ng-repeat="note in sideBar.notes.flatList | orderBy:-sideBar.arrayOrderingSrv.notebookListOrdering track by $index"
           ng-class="{'active':sideBar.isActive(note.id),'locked':sideBar.readOnly(note),'last-child':$last}">
        <a ng-if="note.id"
           href="#/notebook/{{note.id}}"
           class="note-title text-ellipsis"
           title="{{note.name}}">{{note.name}}</a>
        <span ng-if="sideBar.readOnly(note)" class="locked" tooltip="模板"></span>

        <a ng-if="!sideBar.readOnly(note)"
           href="javascript:;"
           class="remove"
           title="删除"
           ng-show="sideBar.removeable(note)"
           ng-click="sideBar.removeNote(note.id)"></a>
      </div>
      <!--repeat end-->
    </div>

    <div class="header-bar history-header-bar">
      <a href="javascript:;" class="history" ng-click="sideBar.toggleHistory()">{{historyOrNotes}}<i class="triangle"></i></a>
    </div>
    <div class="history-list">
      <!--repeat start-->
      <div class="history-item"
           ng-repeat="revision in noteRevisions | orderBy:'time':true"
           ng-class="{'committed':revision.isSubmitted,'active':sideBar.isActive(revision.noteId,revision.id)}">
        <a href="#/notebook/{{revision.noteId}}?v={{revision.id}}{{revision.isSubmitted? '&s=true' : '' }}"
           class="note-title text-ellipsis"
           title="{{revision.message}}">{{revision.message}}</a>
        <p class="commit-time">{{revision.time | date:'yyyy-MM-dd HH:mm:ss'}}</p>
        <p class="commiter"><span class="name">{{revision.committer}}</span></p>
      </div>
      <!--repeat end-->
    </div>
  </div>
</div>
